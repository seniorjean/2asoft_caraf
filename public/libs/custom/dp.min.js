var base_url = base_url || location.origin+'/';
var ajax_submit_form_callback = function(){
    console.log('default_call_back');
};


function init_passwordStrength(input_tag){
    input_tag = input_tag || '#password';
    if ($(input_tag).length) {
        var options = {};
        options.ui = {
            container: '#pwd-container',
            showVerdictsInsideProgressBar: true,
            viewports: {
                progress: '.pwstrength_viewport_progress'
            }
        };
        options.common = {
            debug: false,
            onLoad: function() {
                $('#messages').text('Start typing password');
            }
        };
    }
}

function init_colorpicker(input_tag){
    input_tag = input_tag || '#group_bgcolor';
    if ($(input_tag).length){
        const elem = $(input_tag);
        elem.ColorPickerSliders({
            size: 'lg',
            placement: 'auto bottom',
            previewformat: 'hex',
            color: elem.attr('data-src'),
            swatches: ['#F44336', '#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#2196F3', '#009688', '#FF5722', '#795548', '#607D8B', '#000000'],
            customswatches: false,
            order: {}
        });

        $('button[type="reset"]').on('click', function(e){
            elem.trigger('colorpickersliders.updateColor', elem.attr('data-src'));
        });
    }
}

function init_datatable(){
    let datatable_elemt = $('#zero_config , #dtBasicExample , #datatable');
    let datatable = $(datatable_elemt);
    if(typeof datatable.html() !== 'undefined'){
        if(!has_attr(datatable_elemt,'data-page-length')){
            $(datatable_elemt).attr('data-page-length','50');
        }
        if(!has_attr(datatable_elemt,'width')){
            $(datatable_elemt).attr('width','100%');
        }

        if(!datatable_elemt.hasClass('table-hover')){
            $(datatable_elemt).addClass('table-hover');
        }

        let table_head = $('#zero_config thead, #dtBasicExample thead, #datatable thead');



        datatable_elemt.DataTable({
            "searching": true ,// false to disable search (or any other option)
            "scrollX": true,
            "scrollY": false,
            "language":
                {
                    "sSearch":         "<i class='fas fa-search'></i>",
                    "sLengthMenu":     "<i class='mdi mdi-eye'></i> _MENU_",
                }

        });
    }
    $('.dataTables_length').addClass('bs-select');
}

function init_datepicker(){
	let datepicker_tags = $('.datepicker-here');
	let datepicker_range_tags = $('.datepicker-range-here');
	let datepicker_calendar_tags = $('.datepicker-calendar-here');

	if(datepicker_tags.length>0){
		for(var i = 0; i<datepicker_tags.length; i++){
			var datepicker_tag = $(datepicker_tags[i]);
			//set max date to actual date
			if(!datepicker_tag.hasClass('allow-all-date') && !datepicker_tag.hasClass('future-date-only')){
				datepicker_tag.datepicker({maxDate: new Date() , autoClose:true, language: 'fr',});
			}

			if(datepicker_tag.hasClass('future-date-only')){
				datepicker_tag.datepicker({minDate: new Date(),autoClose:true, language: 'fr'});
			}

			if(datepicker_tag.hasClass('allow-all-date')){
				datepicker_tag.datepicker({autoClose:true, language: 'fr'});
			}
		}
	}

	if(datepicker_range_tags.length > 0){
		for(var u = 0; u<datepicker_range_tags.length ; u++){
			var datepicker_range_tag = $(datepicker_range_tags[u]);
			//set max date to actual date
			if(!datepicker_range_tag.hasClass('allow-all-date') && !datepicker_range_tag.hasClass('future-date-only')){
				datepicker_range_tag.datepicker({maxDate: new Date(),range:true,inline:false , autoClose:true, language: 'fr',});
			}
			if(datepicker_range_tag.hasClass('future-date-only')){
				var autoclose = datepicker_range_tag.attr('data-autoclose') || true;
				if(has_attr(datepicker_range_tag , 'data-autoclose')){autoclose = (autoclose === 'true')}

				var option = {
					minDate: new Date(),
					range: true,
					inline: false,
					autoClose: autoclose,
					language: 'fr',
				}
				datepicker_range_tag.datepicker(option);
			}
			if(datepicker_range_tag.hasClass('allow-all-date')){
				datepicker_range_tag.datepicker({range:true,inline:false , autoClose:true, language: 'fr',});
			}
		}

	}

	if(datepicker_calendar_tags.length > 0){
		for(var v = 0 ; v<datepicker_calendar_tags.length ; datepicker_calendar_tags++){
			var datepicker_calendar_tag = $(datepicker_calendar_tags[v]);
			datepicker_calendar_tag.datepicker({inline:true, language: 'fr',});
		}
	}
}

function init_select2(){
    const selects = $('.select2');
    for(var i = 0 ; i<selects.length; i++){
        const sltc = $(selects)[i];
        $(sltc).select2();
    }
}

$(document).ready(function(){
    //alter default adminlte icon with site icon

    $('#page_preloader').remove();
    $('[class="open"]').removeClass('open');
    $('a[href="'+location.origin+location.pathname+'"]').parent().addClass('open');
    $('a[data-olink="'+location.origin+'/'+router_class+'/'+router_method+'"]').parent().addClass('active');
    $('[data-o-link="'+get_current_link2()+'"]').parent().addClass('active');

    init_passwordStrength();
    init_colorpicker();
    init_datatable();
    setTimeout(function(){
        init_datepicker();
    },1000);

    init_image_boxes();
    init_select2();


    $('.perfecscollbar-wrapper').perfectScrollbar();


    if(typeof upload !== 'undefined' || typeof upload2 !== 'undefined'){
        default_preview_background = 'background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiQAAAD6CAMAAACmhqw0AAAA+VBMVEUAAAD29u3u7unt7ent7enu7uju7uihoqCio6Gio6KjpKOkpaSmpqSmp6WoqKaqq6mqq6qrq6qsrautrauur62wsa6xsa+xsrCys7GztLK0tbK1trS2t7S3t7W4uba5ure6u7e7vLm8vbu9vrvAwL3Awb3DxMHFxcPGxsPHx8TIycXLzMjLzMnMzMnNzsrPz8vP0MzQ0M3S0s/U1NDV1dLX19TY2NTY2NXZ2dba2tXb29bc3Nfc3Njc3dnd3dre3tre39vg4Nvh4dzi4t3i4t7j497k5N/k5ODl5eDl5eHl5uLm5uHn5+Lo6OPp6eTq6uXr6+bs7Oft7eh54KxIAAAAB3RSTlMAHKbl5uztvql9swAABA1JREFUeNrt3VlT01AYgOG0oEEE910URNzFBVFcqCgKirLU/P8fI3QYbEOSdtrMyJzzvHfMlFx833NBQuY0SRrN8UwqabzZSJLGaYNQVacaSdMUVF0zGTMEVTeWmIH6BYkgESSCRJAIEkEiSCRIBIkgESSCRJAIEkEiQSJIBIkgESSCRJAIEgkSQSJIBIkgESSCRJBIkAgSQSJIBIkgESSCRIJEkAgSQSJIBIkgkSARJIJEkAgSQSJIBIkEiSARJIJEkAgSQSJIJEgEiSARJIJEkAgSQSJBIkgEiSARJIJEkAgSCRJBIkgEiSARJIJEgkSQ5PvxbdS+tyEJuZVb0+noTV579geSQGs/SOvqxiYkYfYwra+rbUhC7NNEjUjSJ5CE2P06jaTnIAmxKwe7vb468t3N14WOki1IAuzMwWrf1HCh3Q6S95AEWGe1b0/WlSCBBBJIIAkdSXvt1aNXa21IICld7dJU5+epJUggKV7tzuzRA4/ZHUggKVrtfNdjsXlIIClY7XLPw9NlSCA5vtqLPUguQgLJsdX+zv0fZhsSSPKrXckhWSn5jV8zG5DEiuR1DsnrEiOX0vMbkESKZDWHZLXMSFqsBJIIkOz1vn40sVdqpFgJJDHc3dzsQXKzwkihEkhiQLI+2f3y+3qVkSIlkMSAJFvsQrJYbaRACSRRIMlenj0UcPZlPyPHlUASB5Jsc+7cwevMc5v9jRxTAkkkSPbb+riVZYMYySuBJB4kJRUYySmBJHYkhUZ6lUASOZISIz1KIIkbSamRbiWQxIZkvT2YkS4lkESGpDV9tz2YkX9KIIkLSWs6TY+U9DFypASSqJC0OicfHSrpa2T/k5BEh6R1eDpWR8kARtIZSGJD0jo6QW1fySBGIIkOSavrlL27PwcxAklsSFo9JzFOppBAkl9ta5jTOiGJCslQRiCJCslwRiCJCcmQRiCJCMmwRiCJB8mXoU+YhyQaJM9TSCCBBBJIIIEEEkgggQQSSCCJAsnyzLA9hiQWJCfnSpBAAgkkkATXxFCnPxfU7iB5B0mAXT5Y7Z3t0Y087SDZgCTA7tX6bZ5TGSQBtlwrkgVIgmy+RiMXdiEJsp3b9Rn5nEESaC/O1/P3yMJuBkm4bX94O2rvNiKbWXRIBIkgESSCRJAIEkEiQSJIBIkgESSCRJAIEgkSQSJIBIkgESSCRIJEkAgSQSJIBIkgESQSJIJEkAgSQSJIBIkgkSARJIJEkAgSQSJIBIkEiSARJIJEkAgSQSJIJEgEiSARJIJEkAgSCRJBIkgEiSARJIJEkEiQCBJBIkgEiSARJIJEgkSQCBJBIkgEiSARJBIkgkSQ6P8gGTMDVTeWNA1B1TWTxmlTUFWnGknSaI4bhMoabzaSv+4BHFVoHZzfAAAAAElFTkSuQmCC")';
        active_upload_id = null;
        active_upload = null;
    }

    let error_message   = get_flashdata('error_message');
    let info_message    = get_flashdata('info_message');
    let success_message = get_flashdata('success_message');
    let warning_message = get_flashdata('warning_message');

    if(warning_message !== null){show_message('warning',warning_message)}
    if(error_message !== null){show_message('error',error_message)}
    if(info_message !== null){show_message('info',info_message)}
    if(success_message !== null){show_message('success',success_message)}

});


$(document).on('click','[href="'+base_url+'auth/logout/admin"],[href="'+base_url+'auth/logout"]',{passive:true},function () {
    localStorage.setItem('set_deauth_notification','true');
});
// $(document).on('click','*[disabled]',function () { show_message('error','Cette option est désactivée'); });
$(document).on('keyup','[type="email"]',{passive:true},function () {
    $('#'+$(this).attr('name')+'_email_err_msg').remove();
    var err_email_msg = '<small class="text-danger '+(($(this).hasClass('hide-error'))?'dis-none':'dis-block')+'" id="'+$(this).attr('name')+'_email_err_msg">Adresse email invalide</small>';
    console.log(validateEmail(this.value));
    if(validateEmail(this.value)){
        $(this).removeClass('is-invalid');
        $(this).addClass('is-valid');
        $('#'+$(this).attr('name')+'_email_err_msg').remove();
    }
    else{
        $(this).removeClass('is-valid');
        $(this).addClass('is-invalid');
        $(this).after(err_email_msg);
    }
});
$(document).on('blur keyup','*[required]',{passive:true},function () {
    const tag = $(this);
    if($(tag).attr('type') !== 'file'){
        $('#'+$(this).attr('name')+'_req_err_msg').remove();
        var error_req_msg = '<small class="text-danger '+(($(this).hasClass('hide-error'))?'dis-none':'dis-block')+'" id="'+$(this).attr('name')+'_req_err_msg">Ce champ est obligatoire</small>';
        if($(this).val().trim().length>0){
            $(this).removeClass('is-invalid');
            $(this).addClass('is-valid');
            $('#'+$(this).attr('name')+'_req_err_msg').remove();
        }
        else{
            $(this).removeClass('is-valid');
            $(this).addClass('is-invalid');
            $(this).val('');
            $(this).after(error_req_msg);
        }
    }
});
$(document).on('keyup blur','input[min], input[max] ,textarea[max]',function () {
    if($(this).attr('type')!== 'number'){
        let tag = $(this);
        let tag_id = get_id(this);
        let display = (($(this).hasClass('hide-error'))?'dis-none':'dis-block')
        //has min but not max
        if(has_attr(this,'min') && !has_attr(this,'max')){
            console.log('has min but not max');
            let min_length = $(this).attr('min');
            let msg_tag = $('#mcmsg_'+tag_id+'');
            msg_tag.remove();

            if($(this).val().length<min_length){
                let min_char_msg = '<small class="text-danger '+display+'" id="mcmsg_'+tag_id+'">Saisissez au moins'+min_length+' '+(($(tag).attr('type') != 'number')?'caractères':'')+''+((min_length>1)?'s':'')+'</small>';
                $(this).removeClass('is-valid');
                $(this).addClass('is-invalid');
                $(this).after(min_char_msg);
            }
            else{
                $(this).removeClass('is-invalid');
                $(this).addClass('is-valid');
                msg_tag.remove();
            }
        }
        //has max but not min
        else if(!has_attr(this,'min') && has_attr(this,'max')){
            console.log('has max but not min');

            let max_length = $(this).attr('max');
            let msg_tag = $('#macmsg_'+tag_id+'');
            msg_tag.remove();

            if($(this).val().length>max_length){
                let max_char_msg = '<small class="text-danger '+display+'" id="macmsg_'+tag_id+'">Saisissez au plus '+max_length+' '+(($(tag).attr('type') != 'number')?'caractères':'')+''+((max_length>1)?'s':'')+'</small>';
                $(this).removeClass('is-valid');
                $(this).addClass('is-invalid');
                $(this).after(max_char_msg);
            }
            else{
                $(this).removeClass('is-invalid');
                $(this).addClass('is-valid');
                msg_tag.remove();
            }
        }
        // has min , has max
        else{
            let min_length = $(this).attr('min');
            let max_length = $(this).attr('max');
            //exactly
            if(min_length===max_length){
                console.log('exact');
                let msg_tag = $('#excmsg_'+tag_id+'');
                msg_tag.remove();
                if($(this).val().length>max_length || $(this).val().length<min_length){
                    ex_char_msg = '<small class="text-danger '+display+'" id="excmsg_'+tag_id+'">Saisissez exactement '+max_length+' '+(($(tag).attr('type') != 'number')?'caractères':'')+''+((max_length>1)?'s':'')+'</small>';
                    $(this).removeClass('is-valid');
                    $(this).addClass('is-invalid');
                    $(this).after(ex_char_msg);
                }
                else{
                    $(this).removeClass('is-invalid');
                    $(this).addClass('is-valid');
                    msg_tag.remove();
                }

            }

            //between
            else{
                // console.log('between : '+min_length+' and '+max_length);
                let msg_tag = $('#betcmsg_'+tag_id+'');
                let remain_msg_tag = $('#remain_char_msg_'+tag_id+'');

                var remaining_tag = parseInt(max_length) - parseInt($(this).val().length);
                msg_tag.remove();
                remain_msg_tag.remove();
                if($(this).val().length<min_length || $(this).val().length>max_length)
                {
                    let bet_char_msg = '<small class="text-danger '+display+'" id="betcmsg_'+tag_id+'">Saisissez entre '+min_length+' et '+max_length+' '+(($(tag).attr('type') != 'number')?'caractères':'')+''+((max_length>1)?'s':'')+'</small>';
                    $(this).removeClass('is-valid');
                    $(this).addClass('is-invalid');
                    $(this).after(bet_char_msg);
                    remain_msg_tag.remove();
                }
                else{
                    let remaining_char_msg = '<small class="text-success text-right '+display+'" id="remain_char_msg_'+tag_id+'">'+remaining_tag+'</small>';

                    $(this).removeClass('is-invalid');
                    $(this).addClass('is-valid');
                    $(this).after(remaining_char_msg);
                    msg_tag.remove();
                }

            }
        }
    }
});
$(document).on('keyup blur','input[min], input[max]',function () {
    if($(this).attr('type') == 'number'){
        let tag = $(this);
        let tag_id = get_id(this);
        let value = $(this).val();

        value = ((value.length > 0)?value : 0);
        let display = (($(this).hasClass('hide-error'))?'dis-none':'dis-block');
        //has min but not max
        if(has_attr(this,'min') && !has_attr(this,'max')){
            console.log('has min but not max');
            let min_length = $(this).attr('min');
            let msg_tag = $('#mcmsg_'+tag_id+'');
            msg_tag.remove();

            if(parseFloat(value)<min_length){
                let min_char_msg = '<small class="text-danger '+display+'" id="mcmsg_'+tag_id+'">Valeur doit être au moins '+min_length+'</small>';
                $(this).removeClass('is-valid');
                $(this).addClass('is-invalid');
                $(this).after(min_char_msg);
            }
            else{
                $(this).removeClass('is-invalid');
                $(this).addClass('is-valid');
                msg_tag.remove();
            }
        }
        //has max but not min
        else if(!has_attr(this,'min') && has_attr(this,'max')){
            console.log('has max but not min');

            let max_length = $(this).attr('max');
            let msg_tag = $('#macmsg_'+tag_id+'');
            msg_tag.remove();

            if(parseFloat(value)>max_length){
                let max_char_msg = '<small class="text-danger '+display+'" id="macmsg_'+tag_id+'">Valeur doit être au plus '+max_length+'</small>';
                $(this).removeClass('is-valid');
                $(this).addClass('is-invalid');
                $(this).after(max_char_msg);
            }
            else{
                $(this).removeClass('is-invalid');
                $(this).addClass('is-valid');
                msg_tag.remove();
            }
        }
        // has min , has max
        else{
            let min_length = $(this).attr('min');
            let max_length = $(this).attr('max');
            //exactly
            if(min_length===max_length){
                console.log('exact');
                let msg_tag = $('#excmsg_'+tag_id+'');
                msg_tag.remove();
                if(parseFloat(value)>max_length || parseFloat(value)<min_length){
                    ex_char_msg = '<small class="text-danger '+display+'" id="excmsg_'+tag_id+'">Valeur doit être exactement '+max_length+'</small>';
                    $(this).removeClass('is-valid');
                    $(this).addClass('is-invalid');
                    $(this).after(ex_char_msg);
                }
                else{
                    $(this).removeClass('is-invalid');
                    $(this).addClass('is-valid');
                    msg_tag.remove();
                }

            }

            //between
            else{
                // console.log('between : '+min_length+' and '+max_length);
                let msg_tag = $('#betcmsg_'+tag_id+'');
                let remain_msg_tag = $('#remain_char_msg_'+tag_id+'');

                var remaining_tag = parseInt(max_length) - parseInt(value);
                msg_tag.remove();
                remain_msg_tag.remove();
                if(parseFloat(value)<min_length || parseFloat(value)>max_length)
                {
                    let bet_char_msg = '<small class="text-danger '+display+'" id="betcmsg_'+tag_id+'">Valeur doit être entre '+min_length+' et '+max_length+'</small>';
                    $(this).removeClass('is-valid');
                    $(this).addClass('is-invalid');
                    $(this).after(bet_char_msg);
                    remain_msg_tag.remove();
                }
                else{
                    let remaining_char_msg = '<small class="text-success text-right '+display+'" id="remain_char_msg_'+tag_id+'">'+remaining_tag+'</small>';

                    $(this).removeClass('is-invalid');
                    $(this).addClass('is-valid');
                    $(this).after(remaining_char_msg);
                    msg_tag.remove();
                }

            }
        }
    }
});
$(document).on('click','#browse-file',{passive:true},function () {
    console.log('select image using button');
    browse_upload_file($(this).parent().parent().attr('data-upload-id'));
});
$(document).on('click','#preview_area , #preview_area2',{passive:true},function () {
    console.log('select image using preview area');
    browse_upload_file($(this).parent().attr('data-upload-id'));
});
$(document).on('click','.custom-file-container__image-clear',function () {
   setTimeout(function () {
       if(upload.selectedFilesCount === 0)
       {
          $('#preview_area').attr('style',default_preview_background);
       }
   },100)
});
$(document).on('submit','.ajax-form , .ajax_form',{passive:true},function (e) {
    e.preventDefault();
    const form = $(this);
    ajaxSubmit(e, form , ajax_submit_form_callback);
});
$(document).on('click','.preview',{passive:true},function () {
    var picture = $(this).attr('src');
    var image = '<img src="'+picture+'" id="user_pic_here" alt="" alt="user picture" style="max-width:100%">';
    sweetDialog(image);
});
$(document).on('click','.preview_document',{passive:true},function () {
    var picture = $(this).attr('src');
    var image = '<img src="'+picture+'" id="user_pic_here" alt="" alt="user picture" style="max-width:100%">';
    sweetAlertTwo(image,{icon:false,confirm_btn_text:'fermer',confirm_btn_background:'#606059'});
    $('#swall_two .swal-modal').attr('style','width:96%');
});

let dpOpct = 1;

function sweetDialog(html, params){
    params = params || {};
    var prm = {};

    if(typeof params.showCancelButton !== 'undefined'){
        prm.showCancelButton = params.showCancelButton;
    }
    prm.title = params.title || '';
    prm.size  = params.size  || 600;
    prm.cancelButtonText = params.cancelButtonText || 'Fermer';

    Swal.fire({
        title: prm.title,
        html : html,
        width: prm.size,
        showCancelButton: prm.showCancelButton,
        showConfirmButton:false,
        cancelButtonText: prm.cancelButtonText,
        reverseButtons: true,
        padding: '3em',
        backdrop: 'rgba(0,0,123,0.4)',
        showCloseButton:true
    })
}
function remove_tag(tag){
    $(tag).hide('slow');
    setTimeout(function(){
        $(tag).remove();
    },2000);
}
function sweetModal(params){
    hide_loader();
    $('#SweetModal').perfectScrollbar();
    params = params || {};
    var param = {};
    param.html = params.html || '';
    param.title = params.title || '';
    param.size = params.size || 'auto';

    $('#sweetModalBody').html(param.html);
    $('#sweetModalTitle').html(param.title);
    if(param.size !== 'auto'){
        $('#sweetModalDialog').attr('style','width:'+param.size+'');
    }

    $('[href="#SweetModal"]').click();
}
function sweetModal2(params){
    hide_loader();
    $('#SweetModal2').perfectScrollbar();
    params = params || {};
    var param = {};
    param.html = params.html || '';
    param.title = params.title || '';
    param.size = params.size || 'auto';

    $('#SweetModal2 #sweetModalBody').html(param.html);
    $('#SweetModal2 #sweetModalTitle').html(param.title);
    if(param.size !== 'auto'){
        $('#SweetModal2 #sweetModalDialog').attr('style','width:'+param.size+'');
    }

    $('[href="#SweetModal2"]').click();
}
function sweetModal3(params){
    hide_loader();
    $('#SweetModal3').perfectScrollbar();
    params = params || {};
    var param = {};
    param.html = params.html || '';
    param.title = params.title || '';
    param.size = params.size || 'auto';

    $('#SweetModal3 #sweetModalBody').html(param.html);
    $('#SweetModal3 #sweetModalTitle').html(param.title);
    if(param.size !== 'auto'){
        $('#SweetModal3 #sweetModalDialog').attr('style','width:'+param.size+'');
    }

    $('[href="#SweetModal3"]').click();
}
function close_modal1(){ $('#SweetModal [data-dismiss="modal"]').click(); }
function close_modal2(){ $('#SweetModa2 [data-dismiss="modal"]').click(); }
function close_modal3(){ $('#SweetModa3 [data-dismiss="modal"]').click(); }


function hide_by_time(){
    dpOpct-=0.1;
    delay = setTimeout('hide_by_time()',50);

    $('#datepickers-container').attr('style','opacity:'+dpOpct+'');

    if(dpOpct<=0){
        clearTimeout(delay);
        $('#datepickers-container').hide();
    }
}
function browse_upload_file(upload_id){
    if(typeof upload_id != 'undefined'){
        if(typeof upload !== 'undefined'){
            if(upload.uploadId === upload_id){
                upload.selectImage();
                active_upload_id = upload.uploadId;
                active_upload = upload;
            }

        }
        if(typeof upload2!== 'undefined'){
            if(upload2.uploadId === upload_id){
                upload2.selectImage();
                active_upload_id = upload2.uploadId;
                active_upload = upload2;
            }

        }
    }
}
function has_attr(obj,attrib){
    var attr_val = $(obj).attr(attrib);
    return (typeof  attr_val !== 'undefined')
}
function get_form_input(form_id){
    const form = new FormData(document.getElementById(form_id));
    var form_data = {};
    form.forEach(function (value,key) {

        form_data[key]= value;
        console.log(key+':'+value+'\n');
    });
    return form_data;
}
function get_current_url(){
    return location.origin+location.pathname+'/';
}
function get_name(element){
    return $(element).attr('name');
}
function get_id(element){
    return $(element).attr('id');
}
function reset_form(form_id){
    var inputs = $('#'+form_id+' input');

    for(let i = 0; i<inputs.length ; i++)
    {
        $(inputs[i]).val("");
    }
}
var  sweetConfirmCallBackFunction = {
    no:function(){console.log('chosed no')},
    yes:function(){console.log('choosed yes')}
};
var  check_uniquity_callBackFunction = {
    false:function(){console.log('response : false')},
    true:function(){console.log('response : true')}
};
function reinitialize_sweetConfirmCallBack(){
    sweetConfirmCallBackFunction = {
        no:function(){console.log('chosed no')},
        yes:function(){console.log('choosed yes')}
    }
}
function reinitialize_check_uniquityCallBack(){
    check_uniquity_callBackFunction = {
        false:function(){console.log('response :false')},
        true:function(){console.log('response : true')}
    }
}
function sweetConfirm(message , callBack , title) {

    if(typeof callBack === "object")
    {
        if(typeof callBack.no !== 'undefined') sweetConfirmCallBackFunction.no =callBack.no;

        if(typeof callBack.yes !== 'undefined') sweetConfirmCallBackFunction.yes = callBack.yes;
    }

    title = title||'';


    if(typeof message === 'undefined') {message = 'are you sure ?'}

    swal_confirm(title,message , callBack);
}
function check_uniquity(table , column , value , field_id,message,callBack){
    if(value.trim().length> 5)
    {
        let display = (($('#'+field_id).hasClass('hide-error'))?'dis-none':'dis-block');
        if(typeof callBack !== "object" || typeof callBack == 'undefined')
        {
            callBack = {};
            callBack.false = function () {
                console.log('response:false');
            }

            callBack.true = function () {
                console.log('response:true');
            }
        }

        if(typeof message == 'undefined'){
            message = 'Sorry the value you provided alrady exist';
        }

        $.ajax({
                type:'post',
                url:base_url+'ajax/check_uniquity',
                data:{table:table.trim(),column:column.trim(),value:value.trim()},
                cache:false,
                success:function(response){
                    $('#err_msg_'+field_id).remove();
                    if(response == 'false')
                    {
                        callBack.false();
                        var msg = '<small class="text-danger '+display+'" id="err_msg_'+field_id+'">'+message+'</small>';

                        $('#'+field_id).removeClass('is-valid');
                        $('#'+field_id).addClass('is-invalid');
                        $('#'+field_id).after(msg);
                        $('#'+field_id).focus();

                    }
                    else
                    {
                        callBack.true();
                        $('#'+field_id).removeClass('is-invalid');
                        $('#'+field_id).addClass('is-valid');
                        $('#err_msg_'+field_id).remove();
                    }
                }
    });
    }
    if(value.trim().length === 0)
    {
        $('#'+field_id).removeClass('is-invalid');
        $('#err_msg_'+field_id).remove();
    }

}
function check_uniquity_multi_col(table, value , conditions , field_id, message ,callBack){

    let display = (($('#'+field_id).hasClass('hide-error'))?'dis-none':'dis-block');

    if(value.trim().length>= 3)
    {
        if(typeof callBack !== "object")
        {
            callBack.false = console.log('response:false');

            callBack.true = console.log('response:true')
        }

        if(typeof message == 'undefined'){ message = 'Sorry the value you provided alrady exist'; }

        $.ajax({
                type:'post',
                url:base_url+'check_uniquity_multi_col',
                data:{table:table.trim(),conditions:conditions,value:value.trim()},
                cache:false,
                success:function(response){
                $('#err_msg_'+field_id).remove();
                if(response == 'false')
                {
                    callBack.false();
                    var msg = '<small class="text-danger '+display+'" id="err_msg_'+field_id+'">'+message+'</small>';
                    $('#'+field_id).removeClass('is-valid');
                    $('#'+field_id).addClass('is-invalid');
                    $('#'+field_id).after(msg);
                    $('#'+field_id).focus();
                }
                else
                {
                    callBack.true();
                    $('#'+field_id).removeClass('is-invalid');
                    $('#'+field_id).addClass('is-valid');
                    $('#err_msg_'+field_id).remove();
                }
            },
        });

        reinitialize_check_uniquityCallBack();
    }
    else{
        $('#'+field_id).removeClass('is-invalid');
        $('#err_msg_'+field_id).remove();
    }

}
function closeModal(){
    $('[data-dismiss="modal"]').click();
    $('.swal-overlay').remove();
}
function sweetAlertTwo(params){

    $('#sweetAlertTow').remove();

    params = params || {};

    var defaultParams = {
        title: params.title || '',
        titleText: '',
        text: '',
        html: params.html || '',
        footer: '',
        icon: params.icon || undefined,
        iconHtml: undefined,
        toast: false,
        animation: true,
        showClass: {
            popup: 'swal2-show',
            backdrop: 'swal2-backdrop-show',
            icon: 'swal2-icon-show'
        },
        hideClass: {
            popup: 'swal2-hide',
            backdrop: 'swal2-backdrop-hide',
            icon: 'swal2-icon-hide'
        },
        customClass: undefined,
        target:params.target || 'body',
        backdrop:(params.backdrop !== undefined)?params.backdrop:true,
        heightAuto:(params.heightAuto !== undefined)?params.heightAuto:true,
        allowOutsideClick:(params.allowOutsideClick !== undefined)?params.allowOutsideClick:true,
        allowEscapeKey:(params.allowEscapeKey !== undefined)?params.allowEscapeKey:true,
        allowEnterKey:(params.allowEnterKey !== undefined)?params.allowEnterKey:true,
        stopKeydownPropagation:(params.stopKeydownPropagation !== undefined)?params.stopKeydownPropagation:true,
        keydownListenerCapture:(params.keydownListenerCapture !== undefined)?params.keydownListenerCapture:false,
        showConfirmButton:(params.showConfirmButton !== undefined)?params.showConfirmButton : true,
        showCancelButton:(params.showCancelButton !== undefined)?params.showCancelButton:false,
        preConfirm:params.preConfirm || undefined,
        confirmButtonText:params.confirmButtonText || params.confirmButtonText ||'OK',
        confirmButtonAriaLabel:params.confirmButtonAriaLabel || '',
        confirmButtonColor:params.confirmButtonColor || undefined,
        cancelButtonText:params.cancelButtonText || 'Cancel',
        cancelButtonAriaLabel:params.cancelButtonAriaLabel || '',
        cancelButtonColor:params.cancelButtonColor || undefined,
        buttonsStyling:(params.buttonsStyling !== undefined)?params.buttonsStyling:true,
        reverseButtons:(params.reverseButtons !== undefined)?params.reverseButtons:false,
        focusConfirm:(params.focusConfirm !== undefined)?params.focusConfirm:true,
        focusCancel:(params.focusCancel !== undefined)?params.focusCancel:false,
        showCloseButton:(params.showCloseButton !== undefined)?params.showCloseButton:false,
        closeButtonHtml:params.closeButtonHtml || '&times;',
        closeButtonAriaLabel:params.closeButtonAriaLabel || 'Close this dialog',
        showLoaderOnConfirm:(params.showLoaderOnConfirm !== undefined)?params.showLoaderOnConfirm:false,
        imageUrl:params.imageUrl || undefined,
        imageWidth:params.imageWidth || undefined,
        imageHeight:params.imageHeight || undefined,
        imageAlt:params.imageAlt || '',
        timer:params.timer || undefined,
        timerProgressBar:(params.timerProgressBar !== undefined)?params.timerProgressBar:false,
        width:params.width || undefined,
        padding:params.padding || undefined,
        background:params.background || undefined,
        input:params.input || undefined,
        inputPlaceholder:params.inputPlaceholder || '',
        inputValue:params.inputValue || '',
        inputOptions:params.inputOptions || {},
        inputAutoTrim:(params.inputAutoTrim !== undefined)?params.inputAutoTrim:true,
        inputAttributes:params.inputAttributes || {},
        inputValidator:params.inputValidator || undefined,
        validationMessage:params.validationMessage || undefined,
        grow:(params.grow !== undefined)?params.grow:false,
        position:params.position || 'center',
        progressSteps:params.progressSteps || [],
        currentProgressStep:params.currentProgressStep || undefined,
        progressStepsDistance:params.progressStepsDistance || undefined,
        onBeforeOpen:params.onBeforeOpen || undefined,
        onOpen:params.onOpen || undefined,
        onRender:params.onRender || undefined,
        onClose:params.onClose || undefined,
        onAfterClose:params.onAfterClose || undefined,
        onDestroy:params.onDestroy || undefined,
        scrollbarPadding:(params.scrollbarPadding !== undefined)?params.scrollbarPadding:true
    };

    var show_icon = {
        error:'display:none',
        info:'display:none',
        question:'display:none',
        warning:'display:none',
        success:'display:none',
    };

    switch(defaultParams.icon){
        case 'error':show_icon.error = 'display:flex';break;
        case 'info':show_icon.info = 'display:flex';break;
        case 'question':show_icon.question = 'display:flex';break;
        case 'success':show_icon.success = 'display:flex';break;
    }

    var show = {
        html: 'display:block',
        title: ((defaultParams.title.length > 0)?'display:flex':'display:none')
    };



    var html = '<div class="swal2-container swal2-center swal2-backdrop-show" id="sweetAlertTow" style="overflow-y: auto;">'+
        '<div aria-labelledby="swal2-title" aria-describedby="swal2-content" class="swal2-popup swal2-modal swal2-show" tabindex="-1" role="dialog" aria-live="assertive" aria-modal="true" style="display: flex;">'+
        '<div class="swal2-header">'+
        '<ul class="swal2-progress-steps" style="display: none;"></ul>'+
        '<div class="swal2-icon swal2-error" style="'+show_icon.error+'"><span class="swal2-x-mark"> <span class="swal2-x-mark-line-left"></span> <span class="swal2-x-mark-line-right"></span> </span></div>'+
        '<div class="swal2-icon swal2-question" style="'+show_icon.question+'"></div>'+
        '<div class="swal2-icon swal2-warning" style="'+show_icon.warning+'"></div>'+
        '<div class="swal2-icon swal2-info" style="'+show_icon.info+'"><div class="swal2-icon-content">i</div></div>'+
        '<div class="swal2-icon swal2-success" style="'+show_icon.success+'"></div>'+
        '<img class="swal2-image" style="display: none;">'+
        '<h2 class="swal2-title" id="swal2-title" style="'+show.title+'">'+defaultParams.title+'</h2>'+
        '<button type="button" class="swal2-close" onclick="closeSwallTwo();" aria-label="Close this dialog" style="display: flex;">×</button>'+
        '</div>'+
        '<div class="swal2-content">'+
        '<div id="swal2-content" class="swal2-html-container" style="'+show.html+'">'+defaultParams.html+'</div>'+
        '<input class="swal2-input" style="display: none;"><input type="file" class="swal2-file" style="display: none;">'+
        '<div class="swal2-range" style="display: none;"><input type="range">'+
        '<output></output>'+
        '</div>'+
        '<select class="swal2-select" style="display: none;"></select>'+
        '<div class="swal2-radio" style="display: none;"></div>'+
        '<label for="swal2-checkbox" class="swal2-checkbox" style="display: none;"><input type="checkbox"><span class="swal2-label"></span></label><textarea class="swal2-textarea" style="display: none;"></textarea>'+
        '<div class="swal2-validation-message" id="swal2-validation-message"></div>'+
        '</div>'+
        '<div class="swal2-actions">'+
        '<button onclick="closeSwallTwo();" type="button" class="swal2-confirm swal2-styled" aria-label="" style="display: '+((defaultParams.showConfirmButton === true )?'inlinr-block':'none')+'; border-left-color: rgb(48, 133, 214); border-right-color: rgb(48, 133, 214);">'+
        'OK'+
        '</button>'+
        '<button type="button" class="swal2-cancel swal2-styled" aria-label="" style="display: none;">Cancel</button>'+
        '</div>'+
        '<div class="swal2-footer" style="display: none;"></div>'+
        '<div class="swal2-timer-progress-bar" style="display: none;"></div>'+
        '</div>'+
        '</div>';
    $('body').after(html);
    $('body').addClass('pace-done swal2-shown swal2-height-auto');
    $('#swall_two').show('slow');
}
function close_modal(){
    closeModal();
}
function refresh() {
    location.href = location.origin+location.pathname;
}
function reset_btn_state(){
    if(typeof custom_btn_by_id !== 'undefined'){
        custom_btn_by_id.prop('checked',(switch_final_state === true)?false : true);
    }
}
function scrool_to(element_id){
    $('html , body').animate({scrollTop:$('#'+element_id+'').offset().top} , 300);
}
function scrool_within_to(container_id,element_id){
    $('#'+container_id).animate({scrollTop:$('#'+element_id+'').offset().top} , 300);
}
function validateEmail(email) {
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}
function validate_form(form_id , error_message){
    error_message = error_message || 'Vous devez correctement remplire le formulaire pour continuer !';
    required_fields = $('#'+form_id+' *[required]');

    var the_form_id = form_id+'';

    for(var i = 0 ; i < required_fields.length ; i++){

        var field = $(required_fields[i]);

        if(field.attr('type') != 'hidden' && field.attr('type') != 'file')
        {
            field.keyup();
            if(field.val().trim().length>0)
            {
                $('#chk_field_'+i).remove();
                field.removeClass('is-invalid');
                field.addClass('is-valid');
            }
            else
            {
                $('#chk_field_'+i).remove();
                field.removeClass('is-valid');
                field.addClass('is-invalid');
            }

            if(field.attr('type') === 'checkbox'){
                if(field.hasClass('terms_condition'))
                {
                    if($('[type="checkbox"]').prop('checked') === false)
                    {
                        let msgg = '<div id="term_cond_msg"><small class="text-danger small">You must agree with our terms of usage and conditions</small></div>';
                        field.removeClass('is-valid');
                        field.addClass('is-invalid');
                        field.parent().after(msgg);
                    }
                    else
                    {
                        field.removeClass('is-invalid');
                        field.addClass('is-valid');
                        $('#term_cond_msg').remove();
                    }
                }
            }
        }

    }

    total_error = $('#'+the_form_id+' .is-invalid , #'+the_form_id+' .text-danger').length;

    console.log('total-invalid field = '+total_error);

    if(total_error > 0)
    {
        show_error_message(error_message);
        
        $('.is-invalid')[0].focus();

        return false;
    }
    else
    {
        return true
    }


}
function show_error_message(error_msg , footer){
    footer = footer || '';
    sweetAlertTwo({
        icon: 'error',
        title: 'Oops...',
        html: error_msg,
        footer: footer
    })
}
function check_new_image(){
    console.log('checking new image')
    if(active_upload != null && active_upload_id != null){
        var preview_area = $('[data-upload-id="'+active_upload_id+'"] .custom-file-container__image-preview');
        var control_area = $('[data-upload-id="'+active_upload_id+'"] .upload-file-controlls');
        var input_file   = $('[data-upload-id="'+active_upload_id+'"] #customFile');
        var submit_button= $('#'+$('[data-upload-id="'+active_upload_id+'"]').attr('data-submit-btn-id')+'');
        var nex_button   = $('#next_button');
        if(!preview_area.hasClass('multiple-file')){
            setTimeout(function () {
                if(active_upload.selectedFilesCount>0){
                    control_area.show('slow');
                    submit_button.show('slow');
                    input_file.removeClass('is-invalid');
                    input_file.addClass('is-valid');
                    if(typeof nex_button.html() !== 'undefined'){
                        nex_button.removeAttr('disabled');
                        nex_button.show('slow');
                    }

                }
                else{
                    control_area.hide('slow');
                    submit_button.hide('slow');
                    if(typeof nex_button.html() !== 'undefined'){
                        nex_button.attr('disabled','disabled');
                        nex_button.hide('slow');
                    }

                    input_file.removeClass('is-valid');
                    input_file.addClass('is-invalid');
                }

                console.log('total_image : '+upload.selectedFilesCount)
            },100)
        }
    }
}
function get_input_height(input_element){
    if(typeof input_element !== 'undefined'){
        return input_element.clientHeight;
    }
}
function get_input_width(input_element){
    if(typeof input_element !== 'undefined'){
        return input_element.clientWidth;
    }
}
function copy_text(field_or_field_selector , message){

    if(message === undefined){
        message = 'text successfully copied';
    }

    if(field_or_field_selector !== undefined){
        var tag = null;
        if(typeof field_or_field_selector === 'object'){
            tag = field_or_field_selector;
        }

        else if (typeof field_or_field_selector === 'string'){
            tag = $(field_or_field_selector);
        }

        if(tag !== null){
            tag.select();
            document.execCommand("copy");
            show_message('info', message);
        }
    }
}
function limit_string(string , max_length){
    if(string !== undefined && max_length!== undefined){
        string = string.trim();
        var str = '';
        for(var i = 0 ; i<max_length ; i++){

            if(typeof string[i] !== 'undefined'){
                str+= string[i];
            }

        }

        if(string.length > max_length){
            return str+='...';
        }
        else{
            return str;
        }

    }
}
let swallTowAutoClose = true;

function closeSwallTwo() {
    if(swallTowAutoClose){
        $('#sweetAlertTow').remove();
        $('body').attr('class','pace-done');
    }
}
function simulate_items_click(id){
    $('#'+id).click();
}
function write_text(input_id){
    $('#t_'+input_id).text($('#'+input_id).val()+"");
}
function set_flashdata(key , value){
    localStorage.setItem(key , value);
}
function get_flashdata(key){
    var data = localStorage.getItem(key);
    localStorage.removeItem(key);
    return data;
}
function get_current_link2(){
    return get_current_url().substring(0 , (get_current_url().length) - 1);
}
function ajaxSubmit(e, form, callBackFunction) {
    function default_function(){}
    callBackFunction = callBackFunction || default_function;
    const form_id = $(form).attr('id');
    if(validate_form(form_id)) {
        e.preventDefault();
        show_loader();
        const action = form.attr('action');
        const form2 = e.target;
        const data = new FormData(form2);
        $.ajax({
            type: "POST",
            url: action,
            processData: false,
            contentType: false,
            data: data,
            success: function(response)
            {
                Swal.hideLoading();
                if(response.length > 0){
                    response = $.parseJSON(response);
                    if (response.status == true) {
                        show_message('success',response.message , 5000);
                        if(typeof callBackFunction !== 'undefined'){
                            callBackFunction();
                        }
                    }else{
                        show_message('error',response.message,5000);
                    }
                }
                ajax_submit_form_callback = function(){
                    console.log('default callback');
                }
            },
            error:function () {
                Swal.hideLoading();
                show_message('error','an error occurred !!');
            }
        });
    }else {
        show_message('error','Please make sure to fill all the necessary fields')
    }
}
function get_form_data(e , form){
    const action = form.attr('action');
    const form2 = e.target;
    const data = new FormData(form2);
    return data;
}
function enable_tooltip(){
    (function(e,t){'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define(t):e.Popper=t()})(this,function(){'use strict';function e(e){return e&&'[object Function]'==={}.toString.call(e)}function t(e,t){if(1!==e.nodeType)return[];var o=getComputedStyle(e,null);return t?o[t]:o}function o(e){return'HTML'===e.nodeName?e:e.parentNode||e.host}function n(e){if(!e)return document.body;switch(e.nodeName){case'HTML':case'BODY':return e.ownerDocument.body;case'#document':return e.body;}var i=t(e),r=i.overflow,p=i.overflowX,s=i.overflowY;return /(auto|scroll|overlay)/.test(r+s+p)?e:n(o(e))}function r(e){return 11===e?re:10===e?pe:re||pe}function p(e){if(!e)return document.documentElement;for(var o=r(10)?document.body:null,n=e.offsetParent;n===o&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var i=n&&n.nodeName;return i&&'BODY'!==i&&'HTML'!==i?-1!==['TD','TABLE'].indexOf(n.nodeName)&&'static'===t(n,'position')?p(n):n:e?e.ownerDocument.documentElement:document.documentElement}function s(e){var t=e.nodeName;return'BODY'!==t&&('HTML'===t||p(e.firstElementChild)===e)}function d(e){return null===e.parentNode?e:d(e.parentNode)}function a(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var o=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=o?e:t,i=o?t:e,r=document.createRange();r.setStart(n,0),r.setEnd(i,0);var l=r.commonAncestorContainer;if(e!==l&&t!==l||n.contains(i))return s(l)?l:p(l);var f=d(e);return f.host?a(f.host,t):a(e,d(t).host)}function l(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'top',o='top'===t?'scrollTop':'scrollLeft',n=e.nodeName;if('BODY'===n||'HTML'===n){var i=e.ownerDocument.documentElement,r=e.ownerDocument.scrollingElement||i;return r[o]}return e[o]}function f(e,t){var o=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=l(t,'top'),i=l(t,'left'),r=o?-1:1;return e.top+=n*r,e.bottom+=n*r,e.left+=i*r,e.right+=i*r,e}function m(e,t){var o='x'===t?'Left':'Top',n='Left'==o?'Right':'Bottom';return parseFloat(e['border'+o+'Width'],10)+parseFloat(e['border'+n+'Width'],10)}function h(e,t,o,n){return $(t['offset'+e],t['scroll'+e],o['client'+e],o['offset'+e],o['scroll'+e],r(10)?o['offset'+e]+n['margin'+('Height'===e?'Top':'Left')]+n['margin'+('Height'===e?'Bottom':'Right')]:0)}function c(){var e=document.body,t=document.documentElement,o=r(10)&&getComputedStyle(t);return{height:h('Height',e,t,o),width:h('Width',e,t,o)}}function g(e){return le({},e,{right:e.left+e.width,bottom:e.top+e.height})}function u(e){var o={};try{if(r(10)){o=e.getBoundingClientRect();var n=l(e,'top'),i=l(e,'left');o.top+=n,o.left+=i,o.bottom+=n,o.right+=i}else o=e.getBoundingClientRect()}catch(t){}var p={left:o.left,top:o.top,width:o.right-o.left,height:o.bottom-o.top},s='HTML'===e.nodeName?c():{},d=s.width||e.clientWidth||p.right-p.left,a=s.height||e.clientHeight||p.bottom-p.top,f=e.offsetWidth-d,h=e.offsetHeight-a;if(f||h){var u=t(e);f-=m(u,'x'),h-=m(u,'y'),p.width-=f,p.height-=h}return g(p)}function b(e,o){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],p=r(10),s='HTML'===o.nodeName,d=u(e),a=u(o),l=n(e),m=t(o),h=parseFloat(m.borderTopWidth,10),c=parseFloat(m.borderLeftWidth,10);i&&'HTML'===o.nodeName&&(a.top=$(a.top,0),a.left=$(a.left,0));var b=g({top:d.top-a.top-h,left:d.left-a.left-c,width:d.width,height:d.height});if(b.marginTop=0,b.marginLeft=0,!p&&s){var y=parseFloat(m.marginTop,10),w=parseFloat(m.marginLeft,10);b.top-=h-y,b.bottom-=h-y,b.left-=c-w,b.right-=c-w,b.marginTop=y,b.marginLeft=w}return(p&&!i?o.contains(l):o===l&&'BODY'!==l.nodeName)&&(b=f(b,o)),b}function y(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=e.ownerDocument.documentElement,n=b(e,o),i=$(o.clientWidth,window.innerWidth||0),r=$(o.clientHeight,window.innerHeight||0),p=t?0:l(o),s=t?0:l(o,'left'),d={top:p-n.top+n.marginTop,left:s-n.left+n.marginLeft,width:i,height:r};return g(d)}function w(e){var n=e.nodeName;return'BODY'===n||'HTML'===n?!1:'fixed'===t(e,'position')||w(o(e))}function E(e){if(!e||!e.parentElement||r())return document.documentElement;for(var o=e.parentElement;o&&'none'===t(o,'transform');)o=o.parentElement;return o||document.documentElement}function v(e,t,i,r){var p=4<arguments.length&&void 0!==arguments[4]&&arguments[4],s={top:0,left:0},d=p?E(e):a(e,t);if('viewport'===r)s=y(d,p);else{var l;'scrollParent'===r?(l=n(o(t)),'BODY'===l.nodeName&&(l=e.ownerDocument.documentElement)):'window'===r?l=e.ownerDocument.documentElement:l=r;var f=b(l,d,p);if('HTML'===l.nodeName&&!w(d)){var m=c(),h=m.height,g=m.width;s.top+=f.top-f.marginTop,s.bottom=h+f.top,s.left+=f.left-f.marginLeft,s.right=g+f.left}else s=f}return s.left+=i,s.top+=i,s.right-=i,s.bottom-=i,s}function x(e){var t=e.width,o=e.height;return t*o}function O(e,t,o,n,i){var r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf('auto'))return e;var p=v(o,n,r,i),s={top:{width:p.width,height:t.top-p.top},right:{width:p.right-t.right,height:p.height},bottom:{width:p.width,height:p.bottom-t.bottom},left:{width:t.left-p.left,height:p.height}},d=Object.keys(s).map(function(e){return le({key:e},s[e],{area:x(s[e])})}).sort(function(e,t){return t.area-e.area}),a=d.filter(function(e){var t=e.width,n=e.height;return t>=o.clientWidth&&n>=o.clientHeight}),l=0<a.length?a[0].key:d[0].key,f=e.split('-')[1];return l+(f?'-'+f:'')}function L(e,t,o){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=n?E(t):a(t,o);return b(o,i,n)}function S(e){var t=getComputedStyle(e),o=parseFloat(t.marginTop)+parseFloat(t.marginBottom),n=parseFloat(t.marginLeft)+parseFloat(t.marginRight),i={width:e.offsetWidth+n,height:e.offsetHeight+o};return i}function T(e){var t={left:'right',right:'left',bottom:'top',top:'bottom'};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function C(e,t,o){o=o.split('-')[0];var n=S(e),i={width:n.width,height:n.height},r=-1!==['right','left'].indexOf(o),p=r?'top':'left',s=r?'left':'top',d=r?'height':'width',a=r?'width':'height';return i[p]=t[p]+t[d]/2-n[d]/2,i[s]=o===s?t[s]-n[a]:t[T(s)],i}function D(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function N(e,t,o){if(Array.prototype.findIndex)return e.findIndex(function(e){return e[t]===o});var n=D(e,function(e){return e[t]===o});return e.indexOf(n)}function P(t,o,n){var i=void 0===n?t:t.slice(0,N(t,'name',n));return i.forEach(function(t){t['function']&&console.warn('`modifier.function` is deprecated, use `modifier.fn`!');var n=t['function']||t.fn;t.enabled&&e(n)&&(o.offsets.popper=g(o.offsets.popper),o.offsets.reference=g(o.offsets.reference),o=n(o,t))}),o}function k(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=L(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=O(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=C(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?'fixed':'absolute',e=P(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function W(e,t){return e.some(function(e){var o=e.name,n=e.enabled;return n&&o===t})}function B(e){for(var t=[!1,'ms','Webkit','Moz','O'],o=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var i=t[n],r=i?''+i+o:e;if('undefined'!=typeof document.body.style[r])return r}return null}function H(){return this.state.isDestroyed=!0,W(this.modifiers,'applyStyle')&&(this.popper.removeAttribute('x-placement'),this.popper.style.position='',this.popper.style.top='',this.popper.style.left='',this.popper.style.right='',this.popper.style.bottom='',this.popper.style.willChange='',this.popper.style[B('transform')]=''),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function A(e){var t=e.ownerDocument;return t?t.defaultView:window}function M(e,t,o,i){var r='BODY'===e.nodeName,p=r?e.ownerDocument.defaultView:e;p.addEventListener(t,o,{passive:!0}),r||M(n(p.parentNode),t,o,i),i.push(p)}function I(e,t,o,i){o.updateBound=i,A(e).addEventListener('resize',o.updateBound,{passive:!0});var r=n(e);return M(r,'scroll',o.updateBound,o.scrollParents),o.scrollElement=r,o.eventsEnabled=!0,o}function F(){this.state.eventsEnabled||(this.state=I(this.reference,this.options,this.state,this.scheduleUpdate))}function R(e,t){return A(e).removeEventListener('resize',t.updateBound),t.scrollParents.forEach(function(e){e.removeEventListener('scroll',t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function U(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=R(this.reference,this.state))}function Y(e){return''!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function j(e,t){Object.keys(t).forEach(function(o){var n='';-1!==['width','height','top','right','bottom','left'].indexOf(o)&&Y(t[o])&&(n='px'),e.style[o]=t[o]+n})}function K(e,t){Object.keys(t).forEach(function(o){var n=t[o];!1===n?e.removeAttribute(o):e.setAttribute(o,t[o])})}function q(e,t,o){var n=D(e,function(e){var o=e.name;return o===t}),i=!!n&&e.some(function(e){return e.name===o&&e.enabled&&e.order<n.order});if(!i){var r='`'+t+'`';console.warn('`'+o+'`'+' modifier is required by '+r+' modifier in order to work, be sure to include it before '+r+'!')}return i}function G(e){return'end'===e?'start':'start'===e?'end':e}function z(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=me.indexOf(e),n=me.slice(o+1).concat(me.slice(0,o));return t?n.reverse():n}function V(e,t,o,n){var i=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),r=+i[1],p=i[2];if(!r)return e;if(0===p.indexOf('%')){var s;switch(p){case'%p':s=o;break;case'%':case'%r':default:s=n;}var d=g(s);return d[t]/100*r}if('vh'===p||'vw'===p){var a;return a='vh'===p?$(document.documentElement.clientHeight,window.innerHeight||0):$(document.documentElement.clientWidth,window.innerWidth||0),a/100*r}return r}function _(e,t,o,n){var i=[0,0],r=-1!==['right','left'].indexOf(n),p=e.split(/(\+|\-)/).map(function(e){return e.trim()}),s=p.indexOf(D(p,function(e){return-1!==e.search(/,|\s/)}));p[s]&&-1===p[s].indexOf(',')&&console.warn('Offsets separated by white space(s) are deprecated, use a comma (,) instead.');var d=/\s*,\s*|\s+/,a=-1===s?[p]:[p.slice(0,s).concat([p[s].split(d)[0]]),[p[s].split(d)[1]].concat(p.slice(s+1))];return a=a.map(function(e,n){var i=(1===n?!r:r)?'height':'width',p=!1;return e.reduce(function(e,t){return''===e[e.length-1]&&-1!==['+','-'].indexOf(t)?(e[e.length-1]=t,p=!0,e):p?(e[e.length-1]+=t,p=!1,e):e.concat(t)},[]).map(function(e){return V(e,i,t,o)})}),a.forEach(function(e,t){e.forEach(function(o,n){Y(o)&&(i[t]+=o*('-'===e[n-1]?-1:1))})}),i}function X(e,t){var o,n=t.offset,i=e.placement,r=e.offsets,p=r.popper,s=r.reference,d=i.split('-')[0];return o=Y(+n)?[+n,0]:_(n,p,s,d),'left'===d?(p.top+=o[0],p.left-=o[1]):'right'===d?(p.top+=o[0],p.left+=o[1]):'top'===d?(p.left+=o[0],p.top-=o[1]):'bottom'===d&&(p.left+=o[0],p.top+=o[1]),e.popper=p,e}for(var J=Math.min,Q=Math.round,Z=Math.floor,$=Math.max,ee='undefined'!=typeof window&&'undefined'!=typeof document,te=['Edge','Trident','Firefox'],oe=0,ne=0;ne<te.length;ne+=1)if(ee&&0<=navigator.userAgent.indexOf(te[ne])){oe=1;break}var i=ee&&window.Promise,ie=i?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},oe))}},re=ee&&!!(window.MSInputMethodContext&&document.documentMode),pe=ee&&/MSIE 10/.test(navigator.userAgent),se=function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')},de=function(){function e(e,t){for(var o,n=0;n<t.length;n++)o=t[n],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),ae=function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e},le=Object.assign||function(e){for(var t,o=1;o<arguments.length;o++)for(var n in t=arguments[o],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},fe=['auto-start','auto','auto-end','top-start','top','top-end','right-start','right','right-end','bottom-end','bottom','bottom-start','left-end','left','left-start'],me=fe.slice(3),he={FLIP:'flip',CLOCKWISE:'clockwise',COUNTERCLOCKWISE:'counterclockwise'},ce=function(){function t(o,n){var i=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};se(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(i.update)},this.update=ie(this.update.bind(this)),this.options=le({},t.Defaults,r),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=o&&o.jquery?o[0]:o,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(le({},t.Defaults.modifiers,r.modifiers)).forEach(function(e){i.options.modifiers[e]=le({},t.Defaults.modifiers[e]||{},r.modifiers?r.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return le({name:e},i.options.modifiers[e])}).sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(t){t.enabled&&e(t.onLoad)&&t.onLoad(i.reference,i.popper,i.options,t,i.state)}),this.update();var p=this.options.eventsEnabled;p&&this.enableEventListeners(),this.state.eventsEnabled=p}return de(t,[{key:'update',value:function(){return k.call(this)}},{key:'destroy',value:function(){return H.call(this)}},{key:'enableEventListeners',value:function(){return F.call(this)}},{key:'disableEventListeners',value:function(){return U.call(this)}}]),t}();return ce.Utils=('undefined'==typeof window?global:window).PopperUtils,ce.placements=fe,ce.Defaults={placement:'bottom',positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,o=t.split('-')[0],n=t.split('-')[1];if(n){var i=e.offsets,r=i.reference,p=i.popper,s=-1!==['bottom','top'].indexOf(o),d=s?'left':'top',a=s?'width':'height',l={start:ae({},d,r[d]),end:ae({},d,r[d]+r[a]-p[a])};e.offsets.popper=le({},p,l[n])}return e}},offset:{order:200,enabled:!0,fn:X,offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var o=t.boundariesElement||p(e.instance.popper);e.instance.reference===o&&(o=p(o));var n=B('transform'),i=e.instance.popper.style,r=i.top,s=i.left,d=i[n];i.top='',i.left='',i[n]='';var a=v(e.instance.popper,e.instance.reference,t.padding,o,e.positionFixed);i.top=r,i.left=s,i[n]=d,t.boundaries=a;var l=t.priority,f=e.offsets.popper,m={primary:function(e){var o=f[e];return f[e]<a[e]&&!t.escapeWithReference&&(o=$(f[e],a[e])),ae({},e,o)},secondary:function(e){var o='right'===e?'left':'top',n=f[o];return f[e]>a[e]&&!t.escapeWithReference&&(n=J(f[o],a[e]-('right'===e?f.width:f.height))),ae({},o,n)}};return l.forEach(function(e){var t=-1===['left','top'].indexOf(e)?'secondary':'primary';f=le({},f,m[t](e))}),e.offsets.popper=f,e},priority:['left','right','top','bottom'],padding:5,boundariesElement:'scrollParent'},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,o=t.popper,n=t.reference,i=e.placement.split('-')[0],r=Z,p=-1!==['top','bottom'].indexOf(i),s=p?'right':'bottom',d=p?'left':'top',a=p?'width':'height';return o[s]<r(n[d])&&(e.offsets.popper[d]=r(n[d])-o[a]),o[d]>r(n[s])&&(e.offsets.popper[d]=r(n[s])),e}},arrow:{order:500,enabled:!0,fn:function(e,o){var n;if(!q(e.instance.modifiers,'arrow','keepTogether'))return e;var i=o.element;if('string'==typeof i){if(i=e.instance.popper.querySelector(i),!i)return e;}else if(!e.instance.popper.contains(i))return console.warn('WARNING: `arrow.element` must be child of its popper element!'),e;var r=e.placement.split('-')[0],p=e.offsets,s=p.popper,d=p.reference,a=-1!==['left','right'].indexOf(r),l=a?'height':'width',f=a?'Top':'Left',m=f.toLowerCase(),h=a?'left':'top',c=a?'bottom':'right',u=S(i)[l];d[c]-u<s[m]&&(e.offsets.popper[m]-=s[m]-(d[c]-u)),d[m]+u>s[c]&&(e.offsets.popper[m]+=d[m]+u-s[c]),e.offsets.popper=g(e.offsets.popper);var b=d[m]+d[l]/2-u/2,y=t(e.instance.popper),w=parseFloat(y['margin'+f],10),E=parseFloat(y['border'+f+'Width'],10),v=b-e.offsets.popper[m]-w-E;return v=$(J(s[l]-u,v),0),e.arrowElement=i,e.offsets.arrow=(n={},ae(n,m,Q(v)),ae(n,h,''),n),e},element:'[x-arrow]'},flip:{order:600,enabled:!0,fn:function(e,t){if(W(e.instance.modifiers,'inner'))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var o=v(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split('-')[0],i=T(n),r=e.placement.split('-')[1]||'',p=[];switch(t.behavior){case he.FLIP:p=[n,i];break;case he.CLOCKWISE:p=z(n);break;case he.COUNTERCLOCKWISE:p=z(n,!0);break;default:p=t.behavior;}return p.forEach(function(s,d){if(n!==s||p.length===d+1)return e;n=e.placement.split('-')[0],i=T(n);var a=e.offsets.popper,l=e.offsets.reference,f=Z,m='left'===n&&f(a.right)>f(l.left)||'right'===n&&f(a.left)<f(l.right)||'top'===n&&f(a.bottom)>f(l.top)||'bottom'===n&&f(a.top)<f(l.bottom),h=f(a.left)<f(o.left),c=f(a.right)>f(o.right),g=f(a.top)<f(o.top),u=f(a.bottom)>f(o.bottom),b='left'===n&&h||'right'===n&&c||'top'===n&&g||'bottom'===n&&u,y=-1!==['top','bottom'].indexOf(n),w=!!t.flipVariations&&(y&&'start'===r&&h||y&&'end'===r&&c||!y&&'start'===r&&g||!y&&'end'===r&&u);(m||b||w)&&(e.flipped=!0,(m||b)&&(n=p[d+1]),w&&(r=G(r)),e.placement=n+(r?'-'+r:''),e.offsets.popper=le({},e.offsets.popper,C(e.instance.popper,e.offsets.reference,e.placement)),e=P(e.instance.modifiers,e,'flip'))}),e},behavior:'flip',padding:5,boundariesElement:'viewport'},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,o=t.split('-')[0],n=e.offsets,i=n.popper,r=n.reference,p=-1!==['left','right'].indexOf(o),s=-1===['top','left'].indexOf(o);return i[p?'left':'top']=r[o]-(s?i[p?'width':'height']:0),e.placement=T(t),e.offsets.popper=g(i),e}},hide:{order:800,enabled:!0,fn:function(e){if(!q(e.instance.modifiers,'hide','preventOverflow'))return e;var t=e.offsets.reference,o=D(e.instance.modifiers,function(e){return'preventOverflow'===e.name}).boundaries;if(t.bottom<o.top||t.left>o.right||t.top>o.bottom||t.right<o.left){if(!0===e.hide)return e;e.hide=!0,e.attributes['x-out-of-boundaries']=''}else{if(!1===e.hide)return e;e.hide=!1,e.attributes['x-out-of-boundaries']=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var o=t.x,n=t.y,i=e.offsets.popper,r=D(e.instance.modifiers,function(e){return'applyStyle'===e.name}).gpuAcceleration;void 0!==r&&console.warn('WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!');var s,d,a=void 0===r?t.gpuAcceleration:r,l=p(e.instance.popper),f=u(l),m={position:i.position},h={left:Z(i.left),top:Q(i.top),bottom:Q(i.bottom),right:Z(i.right)},c='bottom'===o?'top':'bottom',g='right'===n?'left':'right',b=B('transform');if(d='bottom'==c?-f.height+h.bottom:h.top,s='right'==g?-f.width+h.right:h.left,a&&b)m[b]='translate3d('+s+'px, '+d+'px, 0)',m[c]=0,m[g]=0,m.willChange='transform';else{var y='bottom'==c?-1:1,w='right'==g?-1:1;m[c]=d*y,m[g]=s*w,m.willChange=c+', '+g}var E={"x-placement":e.placement};return e.attributes=le({},E,e.attributes),e.styles=le({},m,e.styles),e.arrowStyles=le({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:'bottom',y:'right'},applyStyle:{order:900,enabled:!0,fn:function(e){return j(e.instance.popper,e.styles),K(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&j(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,o,n,i){var r=L(i,t,e,o.positionFixed),p=O(o.placement,r,t,e,o.modifiers.flip.boundariesElement,o.modifiers.flip.padding);return t.setAttribute('x-placement',p),j(t,{position:o.positionFixed?'fixed':'absolute'}),o},gpuAcceleration:void 0}}},ce});
    $(function() {
        "use strict";

        $(".preloader").fadeOut();







        $(".left-sidebar").hover(
            function() {
                $(".navbar-header").addClass("expand-logo");
            },
            function() {
                $(".navbar-header").removeClass("expand-logo");
            }
        );

        $(".nav-toggler").on('click', function() {
            $("#main-wrapper").toggleClass("show-sidebar");
            $(".nav-toggler i").toggleClass("ti-menu");
        });
        $(".nav-lock").on('click', function() {
            $("body").toggleClass("lock-nav");
            $(".nav-lock i").toggleClass("mdi-toggle-switch-off");
            $("body, .page-wrapper").trigger("resize");
        });
        $(".search-box a, .search-box .app-search .srh-btn").on('click', function() {
            $(".app-search").toggle(200);
            $(".app-search input").focus();
        });




        $(function() {
            $(".service-panel-toggle").on('click', function() {
                $(".customizer").toggleClass('show-service-panel');

            });
            $('.page-wrapper').on('click', function() {
                $(".customizer").removeClass('show-service-panel');
            });
        });



        $('.floating-labels .form-control').on('focus blur', function(e) {
            $(this).parents('.form-group').toggleClass('focused', (e.type === 'focus' || this.value.length > 0));
        }).trigger('blur');




        $(function() {
            $('[data-toggle="tooltip"]').tooltip()
        })



        $(function() {
            $('[data-toggle="popover"]').popover()
        })








        /*var ps = new PerfectScrollbar('.message-body');
         var ps = new PerfectScrollbar('.notifications');
         var ps = new PerfectScrollbar('.scroll-sidebar');
         var ps = new PerfectScrollbar('.customizer-body');*/




        $("body, .page-wrapper").trigger("resize");
        $(".page-wrapper").show();



        $(".list-task li label").click(function() {
            $(this).toggleClass("task-done");
        });


        /* This is for the mini-sidebar if width is less then 1170*/












        /* This is for sidebartoggler*/

        $('.sidebartoggler').on("click", function() {
            $("#main-wrapper").toggleClass("mini-sidebar");
            if ($("#main-wrapper").hasClass("mini-sidebar")) {
                $(".sidebartoggler").prop("checked", !0);
                $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
            } else {
                $(".sidebartoggler").prop("checked", !1);
                $("#main-wrapper").attr("data-sidebartype", "full");
            }
        });
    });
}

function initImageUpload(box) {
    let uploadField = box.querySelector('.image-upload');

    uploadField.addEventListener('change', getFile);

    function getFile(e){
        let file = e.currentTarget.files[0];
        checkType(file);
    }

    function previewImage(file){
        let thumb = box.querySelector('.js--image-preview'),
            reader = new FileReader();
        reader.onload = function() {
            thumb.style.backgroundImage = 'url(' + reader.result + ')';
        }
        reader.readAsDataURL(file);
        thumb.className += ' js--no-default';
    }

    function checkType(file){
        let imageType = /image.*/;
        if (!file.type.match(imageType)) {
            throw 'Datei ist kein Bild';
        } else if (!file){
            throw 'Kein Bild gewählt';
        } else {
            previewImage(file);
        }
    }

}

function init_image_boxes(){
    var boxes = document.querySelectorAll('.image-box');

    if(boxes.length > 0){
        for (let i = 0; i < boxes.length; i++) {
            let box = boxes[i];
            //initDropEffect(box);
            initImageUpload(box);
        }
    }

}







